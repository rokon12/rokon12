<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="canonical" href="https://bazlur.ca/2024/03/22/records-for-cleaner-and-more-expressive-parameterized-tests-in-junit-5/"><title>Records for Cleaner and More Expressive Parameterized Tests in JUnit 5 | Bazlur’s Blog Archive</title><meta name="generator" content="Jekyll v3.9.5" /><meta property="og:title" content="Records for Cleaner and More Expressive Parameterized Tests in JUnit 5" /><meta name="author" content="A N M Bazlur Rahman" /><meta property="og:locale" content="en_US" /><meta name="description" content="A comprehensive archive of articles on Java, Software Development, and Technology" /><meta property="og:description" content="A comprehensive archive of articles on Java, Software Development, and Technology" /><link rel="canonical" href="http://localhost:4000/backup/records-for-cleaner-and-more-expressive-parameterized-tests-in-junit-5.html" /><meta property="og:url" content="http://localhost:4000/backup/records-for-cleaner-and-more-expressive-parameterized-tests-in-junit-5.html" /><meta property="og:site_name" content="Bazlur’s Blog Archive" /><meta property="og:image" content="http://localhost:4000/assets/img/default-og.jpg" /><meta property="og:type" content="website" /><meta name="twitter:card" content="summary" /><meta property="twitter:image" content="http://localhost:4000/assets/img/default-og.jpg" /><meta property="twitter:title" content="Records for Cleaner and More Expressive Parameterized Tests in JUnit 5" /><meta name="twitter:site" content="@bazlur_rahman" /><meta name="twitter:creator" content="@A N M Bazlur Rahman" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","author":{"@type":"Person","name":"A N M Bazlur Rahman","url":"https://bazlur.ca"},"description":"A comprehensive archive of articles on Java, Software Development, and Technology","headline":"Records for Cleaner and More Expressive Parameterized Tests in JUnit 5","image":"http://localhost:4000/assets/img/default-og.jpg","url":"http://localhost:4000/backup/records-for-cleaner-and-more-expressive-parameterized-tests-in-junit-5.html"}</script><style> /* Critical CSS - Inline for faster initial render */ :root { --primary-color: #2563eb; --secondary-color: #7c3aed; --text-color: #1f2937; --text-light: #6b7280; --bg-color: #ffffff; --bg-gray: #f9fafb; } * { margin: 0; padding: 0; box-sizing: border-box; } body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif; line-height: 1.6; color: var(--text-color); background: var(--bg-gray); } .wrapper { max-width: 1200px; margin: 0 auto; padding: 0 2rem; } header { background: var(--bg-color); box-shadow: 0 1px 3px rgba(0,0,0,0.1); position: sticky; top: 0; z-index: 100; } .site-nav { display: flex; justify-content: space-between; align-items: center; padding: 1rem 0; } .site-title { font-size: 1.5rem; font-weight: 700; color: var(--primary-color); text-decoration: none; } .nav-links { display: flex; gap: 2rem; list-style: none; } .nav-links a { color: var(--text-color); text-decoration: none; transition: color 0.2s; } .nav-links a:hover { color: var(--primary-color); } /* Above-the-fold home page styles */ .banner-container { margin: 2rem auto 3rem; text-align: center; } .ascii-banner { display: inline-block; font-family: 'JetBrains Mono', monospace; font-size: 11px; line-height: 1.2; color: var(--primary-color); } @media (max-width: 768px) { .wrapper { padding: 0 1rem; } .ascii-banner { font-size: 6px; } .nav-links { gap: 1rem; } }</style><link rel="preload" href="/assets/css/main.css?v=2" as="style" onload="this.onload=null;this.rel='stylesheet'"> <noscript><link rel="stylesheet" href="/assets/css/main.css?v=2"></noscript><link rel="alternate" type="application/rss+xml" title="Bazlur&#39;s Blog Archive" href="/feed.xml"><link rel="dns-prefetch" href="https://fonts.googleapis.com"><link rel="dns-prefetch" href="https://cdnjs.cloudflare.com"><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&family=JetBrains+Mono:wght@400;500;600;700&display=swap" rel="stylesheet"><body><header class="site-header"><div class="header-wrapper"> <a class="site-title" href="/">Bazlur&#39;s Blog Archive</a> <button class="mobile-menu-toggle" aria-label="Toggle menu" aria-expanded="false"> <span class="hamburger"> <span></span> <span></span> <span></span> </span> </button><nav class="site-nav"> <a class="nav-link" href="/">Home</a> <a class="nav-link" href="/archive">Archive</a> <a class="nav-link" href="/tags">Tags</a> <a class="nav-link" href="/search">Search</a> <a class="nav-link" href="https://bazlur.com/conference/" target="_blank" rel="noopener">Speaking</a> <a class="nav-link" href="/about">About</a> <a class="nav-link nav-link-external" href="https://bazlur.ca" target="_blank" rel="noopener">Original Site →</a></nav></div></header><main class="page-content" aria-label="Content"><p><img src="/backup/images/gemini-generated-image-2.jpeg" alt="" /></p><h1 id="records-for-cleaner-and-more-expressive-parameterized-tests-in-junit-5">Records for Cleaner and More Expressive Parameterized Tests in JUnit 5</h1><h3 id="introduction-"><strong>Introduction</strong> :</h3><p>Parameterized testing in JUnit 5 is a potent technique for executing the same test logic with various inputs. While you can use a variety of data structures, such as custom classes, arrays, or collections, Java records offer a compelling advantage in readability, type safety, and expressiveness. Let’s examine how to leverage Java records for parameterized tests through a concrete example – testing an expression evaluator.</p><h3 id="the-expression-evaluator-scenario">The Expression Evaluator Scenario</h3><p>Consider a simple expression evaluator capable of handling the following:</p><ul><li>Constants (integer values)<li>Basic arithmetic operations: addition, subtraction, multiplication, and division.</ul><p>Here’s a possible implementation using records:</p><pre><code>public sealed interface Expression {

   record Constant(int value) implements Expression { }

   record Addition(Expression left, Expression right) implements Expression {}

   record Subtraction(Expression left, Expression right) implements Expression { }

   record Multiplication(Expression left, Expression right) implements Expression { }

   record Division(Expression left, Expression right) implements Expression { }
}
</code></pre><p>And the expression evaluator:</p><pre><code>public class ExpressionEvaluator {
   public int evaluate(Expression expression) {
       return switch (expression) {
           case Constant(int value) -&gt; value;
           case Addition(var left, var right) -&gt; evaluate(left) + evaluate(right);
           case Subtraction(var left, var right) -&gt; evaluate(left) - evaluate(right);
           case Multiplication(var left, var right) -&gt; evaluate(left) * evaluate(right);
           case Division(var left, var right) -&gt; {
               if (evaluate(right) == 0) {
                   throw new ArithmeticException("Division by zero");
               }
               yield evaluate(left) / evaluate(right);
           }
       };
   }
}
</code></pre><h3 id="traditional-parameterized-test-with-argumentssource"><strong>Traditional Parameterized Test (with ArgumentsSource)</strong></h3><p>Let’s first look at how a parameterized test for this evaluator might be structured using the traditional <a href="https://junit.org/junit5/docs/5.10.2/api/org.junit.jupiter.params/org/junit/jupiter/params/provider/ArgumentsSource.html"><strong>ArgumentsSource</strong></a> method. This will give us a baseline to understand how records can streamline our tests.</p><pre><code>import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.params.ParameterizedTest;
import org.junit.jupiter.params.provider.Arguments;
import org.junit.jupiter.params.provider.MethodSource;

import java.util.function.Supplier;
import java.util.stream.Stream;

import static bazlur.ca.Expression.*;
import static bazlur.ca.ExpressionEvaluatorTest.TestOutcome.Failure;
import static bazlur.ca.ExpressionEvaluatorTest.TestOutcome.Success;

class ExpressionEvaluatorTest {
    private final ExpressionEvaluator evaluator = new ExpressionEvaluator();

    static Stream&lt;Arguments&gt; testCasesForEvaluate() {
        return Stream.of(
                Arguments.of("Evaluating a constant", new Constant(5), 5),
                Arguments.of("Adding two constants", new Addition(new Constant(3), new Constant(2)), 5),
                Arguments.of("Subtracting two constants", new Subtraction(new Constant(10), new Constant(4)), 6),
                Arguments.of("Multiplying by zero", new Multiplication(new Constant(6), new Constant(0)), 0),
                Arguments.of("Dividing by a non-zero constant", new Division(new Constant(8), new Constant(2)), 4),
                Arguments.of("Dividing by zero - Expecting ArithmeticException", new Division(new Constant(5), new Constant(0)), ArithmeticException.class)
        );
    }

    @ParameterizedTest(name = "[{index}] {0}")
    @MethodSource("testCasesForEvaluate")
    void testEvaluate(String description, Expression expression, Object expectedOutcome) { // Changes here
        if (expectedOutcome instanceof Class&lt;?&gt;) {
            Class&lt;? extends Exception&gt; expectedException = (Class&lt;? extends Exception&gt;) expectedOutcome;
            Assertions.assertThrows(expectedException, () -&gt; evaluator.evaluate(expression));
        } else {
            int expectedResult = (int) expectedOutcome;
            Assertions.assertEquals(expectedResult, evaluator.evaluate(expression));
        }
    }
}
</code></pre><h3 id="refactoring-with-records"><strong>Refactoring with Records</strong></h3><p>Now, let’s see how we can improve the clarity and maintainability of our tests by introducing records.</p><p><strong>The TestCase Record:</strong></p><pre><code>record TestCase(String description, Expression expression, TestOutcome expectedOutcome) {}
</code></pre><p><strong>Sealed TestOutcome:</strong></p><pre><code>sealed interface TestOutcome {

    record Success(int value) implements TestOutcome {}

    record Failure(Supplier&lt;? extends RuntimeException&gt; exceptionSupplier) implements TestOutcome {}
}
</code></pre><p><br /></p><p><strong>Refactored Tests</strong></p><pre><code>private static Stream&lt;TestCase&gt; provideExpressionsForEvaluate() {
    return Stream.of(
            new TestCase("Valid constant", new Constant(5), new Success(5)),
            new TestCase("Valid addition", new Addition(new Constant(2), new Constant(3)), new Success(5)),
            new TestCase("Division by zero", new Division(new Constant(6), new Constant(0)), new Failure(ArithmeticException::new)),
            new TestCase("Valid subtraction", new Subtraction(new Constant(10), new Constant(3)), new Success(7)),
            new TestCase("Valid multiplication", new Multiplication(new Constant(3), new Constant(4)), new Success(12)),
            new TestCase("Negative result", new Subtraction(new Constant(5), new Constant(8)), new Success(-3)),
            new TestCase("Combined operations",
                    new Addition(new Constant(3), new Multiplication(new Constant(2), new Constant(5))),
                    new Success(13)),

            new TestCase("Nested division by zero",
                    new Division(new Constant(12), new Division(new Constant(6), new Constant(0))),
                    new Failure(ArithmeticException::new))
    );
}

@ParameterizedTest
@MethodSource("provideExpressionsForEvaluate")
void testEvaluateExpression(TestCase testCase) {
    ExpressionEvaluator evaluator = new ExpressionEvaluator();

    switch (testCase.expectedOutcome()) {
        case Success(int expectedResult) -&gt;
                Assertions.assertEquals(expectedResult, evaluator.evaluate(testCase.expression()),
                        "Incorrect evaluation for: " + testCase.description());
        case Failure(Supplier&lt;? extends RuntimeException&gt; exceptionSupplier) -&gt;
                Assertions.assertThrows(exceptionSupplier.get().getClass(),
                        () -&gt; evaluator.evaluate(testCase.expression()),
                        "Incorrect error handling for: " + testCase.description());
    }
}
</code></pre><h3 id="benefits-of-the-record-based-approach">Benefits of the Record-Based Approach</h3><p><br /></p><p>Let’s break down the key advantages of using records in this context:</p><ul><li><strong>Clarity and Conciseness</strong> : The <strong>TestCase</strong> record makes the structure of test data immediately apparent. It clearly separates the test description, the input expression, and the expected outcome.</ul><ul><li><strong>Type Safety:</strong> By explicitly typing expressions and outcomes, we reduce the potential for runtime errors caused by mismatched data types.</ul><ul><li><strong>Flexible Outcome Handling:</strong> The <strong>Failure</strong> record allows us to model various error scenarios, including associating a specific exception type with the failure.</ul><ul><li><strong>Pattern Matching:</strong> Records and sealed interfaces make our test case logic more concise through the use of pattern matching or switch expressions</ul><h3 id="conclusion">Conclusion</h3><p>Records offer a compelling solution for structuring test cases in JUnit 5 parameterized tests. When compared to traditional approaches, records significantly improve code clarity, type safety, and overall maintainability.</p><hr /><h3 id="discover-more-from-a-n-m-bazlur-rahman">Discover more from A N M Bazlur Rahman</h3><p>Subscribe to get the latest posts sent to your email.<br /> Type your email… {#subscribe-email}</p><p>Subscribe {#subscribe-submit}</p></main><footer class="site-footer"><div class="footer-content"><p>A comprehensive archive of articles on Java, Software Development, and Technology</p><p>© 2025 A N M Bazlur Rahman. All articles are archived from <a href="https://bazlur.ca">bazlur.ca</a></p><p> <a href="/feed.xml">RSS Feed</a> • <a href="https://twitter.com/bazlur_rahman">Twitter</a> • <a href="https://github.com/rokon12">GitHub</a></p></div></footer><script> // Fade-in animations on scroll document.addEventListener('DOMContentLoaded', function() { const observerOptions = { threshold: 0.1, rootMargin: '0px 0px -100px 0px' }; const observer = new IntersectionObserver(function(entries) { entries.forEach(entry => { if (entry.isIntersecting) { entry.target.classList.add('visible'); observer.unobserve(entry.target); } }); }, observerOptions); // Observe fade-in elements document.querySelectorAll('.fade-in, .fade-in-up, .fade-in-left, .fade-in-right, .stagger-animation').forEach(el => { observer.observe(el); }); // Add fade-in classes to post cards document.querySelectorAll('.post-card').forEach((card, index) => { card.classList.add('fade-in-up'); card.style.transitionDelay = `${index * 0.1}s`; }); // Removed duplicate image observer - handled by image-optimization.js }); </script> <script defer src="/assets/js/terminal.js"></script> <script defer src="/assets/js/image-optimization.js"></script> <script> if ('loading' in HTMLImageElement.prototype) { const images = document.querySelectorAll('img[loading="lazy"]'); images.forEach(img => { img.src = img.dataset.src || img.src; }); } else { // Fallback for browsers that don't support lazy loading const script = document.createElement('script'); script.src = 'https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.3.2/lazysizes.min.js'; document.body.appendChild(script); } </script> <script> document.addEventListener('DOMContentLoaded', function() { // Mobile menu toggle const mobileMenuToggle = document.querySelector('.mobile-menu-toggle'); const siteNav = document.querySelector('.site-nav'); if (mobileMenuToggle) { mobileMenuToggle.addEventListener('click', function() { const isExpanded = this.getAttribute('aria-expanded') === 'true'; this.setAttribute('aria-expanded', !isExpanded); siteNav.classList.toggle('is-active'); document.body.classList.toggle('menu-open'); }); // Close menu when clicking outside document.addEventListener('click', function(e) { if (!e.target.closest('.site-header') && siteNav.classList.contains('is-active')) { mobileMenuToggle.setAttribute('aria-expanded', 'false'); siteNav.classList.remove('is-active'); document.body.classList.remove('menu-open'); } }); } // Initialize theme const savedTheme = localStorage.getItem('theme') || 'dark'; document.documentElement.setAttribute('data-theme', savedTheme); // Global search shortcut document.addEventListener('keydown', function(e) { // Focus search with / if (e.key === '/' && !e.metaKey && !e.ctrlKey) { const searchInput = document.querySelector('.quick-search-input') || document.querySelector('#search-input'); if (searchInput && document.activeElement !== searchInput) { e.preventDefault(); searchInput.focus(); document.body.classList.add('search-focused'); } } // Clear focus on ESC if (e.key === 'Escape') { const searchInput = document.querySelector('.quick-search-input') || document.querySelector('#search-input'); if (searchInput && document.activeElement === searchInput) { searchInput.blur(); searchInput.value = ''; document.body.classList.remove('search-focused'); } } }); }); </script> <button class="back-to-top" id="back-to-top" aria-label="Back to top"> <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="18 15 12 9 6 15"></polyline> </svg> </button> <script> document.addEventListener('DOMContentLoaded', function() { const backToTopButton = document.getElementById('back-to-top'); // Show/hide button based on scroll position function toggleBackToTop() { if (window.scrollY > 300) { backToTopButton.classList.add('visible'); } else { backToTopButton.classList.remove('visible'); } } // Throttle scroll events let isScrolling = false; window.addEventListener('scroll', function() { if (!isScrolling) { window.requestAnimationFrame(function() { toggleBackToTop(); isScrolling = false; }); isScrolling = true; } }); // Smooth scroll to top backToTopButton.addEventListener('click', function() { window.scrollTo({ top: 0, behavior: 'smooth' }); }); // Initial check toggleBackToTop(); }); </script> <script> if ('serviceWorker' in navigator) { window.addEventListener('load', function() { navigator.serviceWorker.register('/sw.js').then(function(registration) { console.log('ServiceWorker registration successful'); }, function(err) { console.log('ServiceWorker registration failed: ', err); }); }); } </script>